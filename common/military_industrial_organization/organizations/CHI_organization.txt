#####################

###  ##  #  # # #  ## 
 #  #  # ## # # # #   
 #  #### # ## ##   #  
 #  #  # #  # # #   # 
 #  #  # #  # # # ## 

 #################### 


# CHI_sino_german_technical_mission_organization = { # TODO
	# include = generic_heavy_tank_organization
	# icon = GFX_idea_porsche
	# allowed = {	
		# always = no
		# has_dlc = "Arms Against Tyranny"
		# # is_literally_china = yes
		# # OR = {
			# # NOT = { has_dlc = "No Compromise, No Surrender" }
			# # AND = {
				# # has_dlc = "No Compromise, No Surrender"
				# # NOT = {
					# # OR = {
						# # tag = CHI
						# # tag = PRC
					# # }
				# # }
			# # }
		# # } 
	# }
	# # available = {
		# # owner = {
			# # OR = {
				# # hidden_trigger = {
					# # has_completed_focus = CHI_chinese_panzers
					# # has_completed_focus = CHI_sea_chinese_panzers
				# # }
				# # custom_trigger_tooltip = {
					# # tooltip = CHI_chinese_panzers_TT
					# # OR = {
						# # has_completed_focus = CHI_chinese_panzers
						# # has_completed_focus = CHI_sea_chinese_panzers
					# # }
				# # }
				
				# # has_idea = german_advisors
			# # }
			# # NOT = {
				# # has_war_with = GER
			# # }
		# # }
	# # }
# }

CHI_shanghai_arsenal = {
	icon = GFX_idea_CHI_shanghai_arsenal
	allowed = {
		is_literally_china = yes
		NOT = { original_tag = PRC }
		# has_dlc = "No Compromise, No Surrender"
		has_dlc = "Arms Against Tyranny"
	}
	available = {
		# IF = {
			# limit = {
				# FROM = { NOT = { original_tag = CHI } }
			# }
			# owner = { controls_state = CHI.mio_locations^7 } # #613 Shanghai
		# }
		# IF = {
			# limit = {
				# FROM = { original_tag = CHI }
			# }
			# OR = {
				# owner = { has_completed_focus = CHI_relocate_factories_from_the_coast }
				# owner = { controls_state = CHI.mio_locations^7 } # #613 Shanghai
			# }
		# }
		owner = { 
			controls_state = 1145 # Shanghai
			has_tech = own_tank_school_tech 
		}
	}
	equipment_type = { armored_car_equipment mio_cat_eq_all_light_tank }
	research_categories = { cat_armored_cars mio_cat_tech_light_armor_and_modules  }
	tree_header_text = {
		text = mio_header_design_and_production
		x = 3
	}
	tree_header_text = {
		text = mio_header_equipment_and_specialization
		x = 7
	}
	
	initial_trait = {
		name = generic_mio_initial_trait_light_armored_manufacturer
		equipment_bonus = {
			armor_value = 0.05
			defense =0.05
			build_cost_ic = -0.05
		}
	}
	trait = {
		token = generic_mio_trait_simplified_suspension
		name = generic_mio_trait_simplified_suspension
		icon = GFX_generic_mio_trait_icon_reliability
		equipment_bonus = {
			reliability = 0.05
		}
		position = { x=1 y=0 }
	}
	
	trait = {
		token = generic_mio_trait_crew_ergonomics
		name = generic_mio_trait_crew_ergonomics
		icon = GFX_generic_mio_trait_icon_defense
		equipment_bonus = {
			maximum_speed = 0.02
			defense = 0.02
		}
		position = { x=4 y=0 }
		relative_position_id = generic_mio_trait_simplified_suspension
	}
	
	trait = {
		token = generic_mio_trait_reinforced_wheels
		name = generic_mio_trait_reinforced_wheels
		icon = GFX_generic_mio_department_icon_armored_car_engine
		any_parent = { generic_mio_trait_simplified_suspension }
		equipment_bonus = {
			reliability = 0.05
			maximum_speed = 0.05
		}
		position = { x=0 y=2 }
		relative_position_id = generic_mio_trait_simplified_suspension
	}
	trait = {
		token = generic_mio_trait_command_upgrades
		name = generic_mio_trait_command_upgrades
		icon = GFX_generic_mio_trait_icon_breakthrough
		any_parent = { generic_mio_trait_crew_ergonomics }
		equipment_bonus = {
			breakthrough = 0.05
		}
		position = { x=0 y=2 }
		relative_position_id = generic_mio_trait_crew_ergonomics
	}
	
	trait = {
		token = generic_mio_trait_standardized_components
		name = generic_mio_trait_standardized_components
		icon = GFX_generic_mio_trait_icon_efficiency_gain
		all_parents = { generic_mio_trait_simplified_suspension generic_mio_trait_crew_ergonomics }
		position = { x=2 y=1 }
		relative_position_id = generic_mio_trait_simplified_suspension
		production_bonus = {
			production_efficiency_gain_factor = 0.15
			production_resource_need_factor = -0.15
		}
	}
	trait = {
		token = generic_mio_trait_improved_tooling
		name = generic_mio_trait_improved_tooling
		icon = GFX_generic_mio_trait_icon_efficiency_cap
		all_parents = { generic_mio_trait_reinforced_wheels generic_mio_trait_standardized_components generic_mio_trait_command_upgrades }
		position = { x=0 y=2 }
		relative_position_id = generic_mio_trait_standardized_components
		production_bonus = {
			production_efficiency_cap_factor = 0.1
		}
	}
	trait = {
		token = generic_mio_trait_locally_sourced_alloys
		name = generic_mio_trait_locally_sourced_alloys
		icon = GFX_generic_mio_trait_icon_resources
		special_trait_background = yes
		any_parent = { generic_mio_trait_improved_tooling }
		mutually_exclusive = { generic_mio_trait_quality_improvements }
		position = { x=-1 y=1 }
		relative_position_id = generic_mio_trait_improved_tooling
		production_bonus = {
			production_resource_need_factor = -0.15
		}
	}
	trait = {
		token = generic_mio_trait_quality_improvements
		name = generic_mio_trait_quality_improvements
		icon = GFX_generic_mio_department_icon_tank_general_armor
		any_parent = { generic_mio_trait_improved_tooling }
		mutually_exclusive = { generic_mio_trait_locally_sourced_alloys}
		position = { x=1 y=1 }
		relative_position_id = generic_mio_trait_improved_tooling
		equipment_bonus = {
			armor_value = 0.1
			defense = 0.1
		}
	}
	trait = {
		token = generic_mio_trait_reinforcing_plates
		name = generic_mio_trait_reinforcing_plates
		icon = GFX_generic_mio_trait_icon_armor_value
		equipment_bonus = {
			armor_value = 0.05
			defense = 0.02
		}
		position = { x=2 y=0 }
		relative_position_id = generic_mio_trait_crew_ergonomics
	}
	trait = {
		token = generic_mio_trait_long_barreled_guns
		name = generic_mio_trait_long_barreled_guns
		icon = GFX_generic_mio_trait_icon_ap_attack
		all_parents = { generic_mio_trait_crew_ergonomics generic_mio_trait_reinforcing_plates }
		mutually_exclusive = { generic_mio_trait_self_cycling_guns }
		position = { x=-1 y=2 }
		relative_position_id = generic_mio_trait_reinforcing_plates
		equipment_bonus = {
			ap_attack = 0.05
			hard_attack = 0.05
		}
	}
	trait = {
		token = generic_mio_trait_self_cycling_guns
		name = generic_mio_trait_self_cycling_guns
		icon = GFX_generic_mio_trait_icon_soft_attack
		special_trait_background = yes
		all_parents = { generic_mio_trait_crew_ergonomics generic_mio_trait_reinforcing_plates }
		mutually_exclusive = { generic_mio_trait_long_barreled_guns }
		position = { x=1 y=2 }
		relative_position_id = generic_mio_trait_reinforcing_plates
		equipment_bonus = {
			soft_attack = 0.05
			air_attack = 0.05
		}
	}
	trait = {
		token = generic_mio_trait_heavy_anti_tank_gun
		name = generic_mio_trait_heavy_anti_tank_gun
		icon = GFX_generic_mio_trait_icon_hard_attack
		any_parent = { generic_mio_trait_long_barreled_guns generic_mio_trait_self_cycling_guns }
		mutually_exclusive = { generic_mio_trait_superior_fuel_mix }
		position = { x=0 y=2 }
		relative_position_id = generic_mio_trait_long_barreled_guns
		equipment_bonus = {
			armor_value = 0.05
			hard_attack = 0.05
		}
	}
	trait = {
		token = generic_mio_trait_superior_fuel_mix
		name = generic_mio_trait_superior_fuel_mix
		icon = GFX_generic_mio_trait_icon_fuel_consumption
		special_trait_background = yes
		any_parent = { generic_mio_trait_long_barreled_guns generic_mio_trait_self_cycling_guns }
		mutually_exclusive = { generic_mio_trait_heavy_anti_tank_gun }
		position = { x=2 y=2 }
		relative_position_id = generic_mio_trait_long_barreled_guns
		equipment_bonus = {
			fuel_consumption = -0.1
			reliability = 0.05
		}
	}
}

#####################

 ## #  # ### ###   ## 
#   #  #  #  #  # #   
 #  ####  #  ###   #  
  # #  #  #  #      # 
##  #  # ### #    ##  
 
#####################

CHI_jiangnan_shipyard_group_organization = {
	include = generic_task_force_ship_organization
	icon = GFX_idea_generic_naval_manufacturer_3
	allowed = {
		is_literally_china = yes
		NOT = { has_dlc = "No Compromise, No Surrender" }
		has_dlc = "Arms Against Tyranny"
	}
	available = {
		owner = { controls_state = 1031 } # #613 Shanghai
	}
}


CHI_dagu_shipyard_organization = {
	include = generic_raider_ship_organization
	icon = GFX_idea_CHI_dagu
	allowed = {
		is_literally_china = yes
		NOT = { has_dlc = "No Compromise, No Surrender" }
		has_dlc = "Arms Against Tyranny"
	}
	available = {
		FROM = { controls_state = 608 } #608 Beijing
	}
}

CHI_kiangnan_shipyard_group_organization_sea = {
	include = generic_task_force_ship_organization
	icon = GFX_idea_CHI_kiangnan
	allowed = {	
		is_literally_china = yes
		has_dlc = "No Compromise, No Surrender"
		has_dlc = "Arms Against Tyranny"
	}
	available = {
		# IF = {
			# limit = {
				# FROM = { NOT = { original_tag = CHI } }
			# }
			owner = { controls_state = 1145 } # #613 Shanghai
		# }
		# IF = {
			# limit = {
				# FROM = { original_tag = CHI }
			# }
			# OR = {
				# owner = { has_completed_focus = CHI_relocate_factories_from_the_coast }
				# owner = { controls_state = CHI.mio_locations^7 } # #613 Shanghai
			# }
		# }
	}

	add_trait = {
		token = generic_mio_trait_simplified_hulls
		name = generic_mio_trait_simplified_hulls
		icon = GFX_generic_mio_department_icon_ship_general_production
		special_trait_background = yes

		relative_position_id = generic_mio_trait_long_range_cruising

		position = { x=1 y=0 }
		
		mutually_exclusive = { generic_mio_trait_high_speed_cruising generic_mio_trait_long_range_cruising }

		equipment_bonus = {
			build_cost_ic = -0.15
			naval_range = -0.02
			naval_speed = -0.02
		}
	}
	override_trait = {
		token = generic_mio_trait_long_range_cruising
		mutually_exclusive = { generic_mio_trait_high_speed_cruising generic_mio_trait_simplified_hulls }
	}
	override_trait = {
		token = generic_mio_trait_high_speed_cruising
		mutually_exclusive = { generic_mio_trait_long_range_cruising generic_mio_trait_simplified_hulls }
	}
	override_trait = {
		token = generic_mio_trait_splinter_protection
		any_parent = { generic_mio_trait_long_range_cruising generic_mio_trait_high_speed_cruising generic_mio_trait_simplified_hulls }
	}
	add_trait = {
		token = generic_mio_trait_modular_construction
		name = generic_mio_trait_modular_construction
		icon = GFX_generic_mio_department_icon_ship_capital_ship_production
		special_trait_background = yes

		position = { x=1 y=1 }
		relative_position_id = generic_mio_trait_high_speed_cruising
		
		any_parent = { generic_mio_trait_long_range_cruising generic_mio_trait_high_speed_cruising generic_mio_trait_simplified_hulls }
		all_parents = { generic_mio_trait_secondary_fire_director_control }

		limit_to_equipment_type = { mio_cat_eq_all_carrier mio_cat_eq_all_cruiser }

		equipment_bonus = {
			build_cost_ic = -0.1
		}
	}
}

CHI_dagu_shipyard_organization_sea = {
	include = generic_raider_ship_organization
	icon = GFX_idea_CHI_dagu
	allowed = {	
		is_literally_china = yes
		has_dlc = "No Compromise, No Surrender"
		has_dlc = "Arms Against Tyranny"
	}
	available = {
		# IF = {
			# limit = {
				# FROM = { NOT = { original_tag = CHI } }
			# }
			owner = { controls_state = 608 } #608 Beijing
		# }
		# IF = {
			# limit = {
				# FROM = { original_tag = CHI }
			# }
			# OR = {
				# owner = { has_completed_focus = CHI_relocate_factories_from_the_coast }
				# owner = { controls_state = CHI.mio_locations^1 } #608 Beijing
			# }
		# }
	}

	add_trait = {
		token = generic_mio_trait_modular_construction
		name = generic_mio_trait_modular_construction
		icon = GFX_generic_mio_department_icon_ship_capital_ship_production
		special_trait_background = yes
		position = { x=2 y=1 }

		relative_position_id = generic_mio_trait_long_range_raiding
		any_parent = { generic_mio_trait_long_range_raiding generic_mio_trait_high_speed_raiding }

		equipment_bonus = {
			build_cost_ic = -0.1
		}
	}
	add_trait = {
		token = generic_mio_trait_increased_amount_of_bulkheads
		name = generic_mio_trait_increased_amount_of_bulkheads
		icon = GFX_generic_mio_trait_icon_resources
		special_trait_background = yes
		position = { x=-2 y=1 }

		relative_position_id = generic_mio_trait_high_speed_raiding
		any_parent = { generic_mio_trait_long_range_raiding generic_mio_trait_high_speed_raiding }

		equipment_bonus = {
			max_strength = 0.05
		}
	}
}

###########################

###  #    ##  #  # ###  ## 
#  # #   #  # ## # #   #   
###  #   #### # ## ##   #  
#    #   #  # #  # #     # 
#    ### #  # #  # ### ##  

###########################

# CHI_camco_organization = {
	# include = generic_medium_aircraft_organization
	# icon = GFX_idea_CHI_camco
	# allowed = {	
		# always = no # TODO выпилить?
		# is_literally_china = yes
		# NOT = { has_dlc = "Waking the Tiger" }
		# has_dlc = "Arms Against Tyranny"
	# }
# }
# CHI_camco_medium_organization = {
	# include = generic_medium_aircraft_organization
	# icon = GFX_idea_CHI_camco
	# allowed = {	
		# always = no # TODO выпилить?
		# is_literally_china = yes
		# NOT = { has_dlc = "No Compromise, No Surrender" }
		# has_dlc = "Arms Against Tyranny"
	# }
	# available = {
		# # owner = { 
			# # hidden_trigger = {
				# # OR = {
					# # has_completed_focus = CHI_camco 
					# # has_completed_focus = CHI_sea_camco 
				# # }
			# # }
			# # custom_trigger_tooltip = {
				# # tooltip = CHI_camco_tt
				# # OR = {
					# # has_completed_focus = CHI_camco 
					# # has_completed_focus = CHI_sea_camco 
				# # }
			# # }
			
		# # }

	# }
# }
# CHI_camco_fighter_organization = {
	# include = generic_light_aircraft_organization
	# icon = GFX_idea_CHI_camco
	# allowed = {	
		# always = no # TODO выпилить?
		# is_literally_china = yes
		# NOT = { has_dlc = "No Compromise, No Surrender" }
		# has_dlc = "Arms Against Tyranny"
	# }
	# available = {
		# # owner = {
			# # hidden_trigger = {
				# # OR = {
					# # has_completed_focus = CHI_local_fighter_production 
					# # has_completed_focus = CHI_sea_local_fighter_production 
				# # }
			# # }
			# # custom_trigger_tooltip = {
				# # tooltip = CHI_local_fighter_production_tt
				# # OR = {
					# # has_completed_focus = CHI_local_fighter_production 
					# # has_completed_focus = CHI_sea_local_fighter_production 
				# # }
			# # } 
		# # }
	# }
# }
# CHI_camco_bomber_organization = {
	# include = generic_cas_aircraft_organization
	# icon = GFX_idea_CHI_camco
	# allowed = {	
		# always = no # TODO выпилить?
		# is_literally_china = yes
		# NOT = { has_dlc = "No Compromise, No Surrender" }
		# has_dlc = "Arms Against Tyranny"
	# }
	# available = {
		# # owner = {
			# # hidden_trigger = {
				# # OR = {
					# # has_completed_focus = CHI_local_bomber_production 
					# # has_completed_focus = CHI_sea_local_bomber_production 
				# # }
			# # }
			# # custom_trigger_tooltip = {
				# # tooltip = CHI_local_bomber_production_tt
				# # OR = {
					# # has_completed_focus = CHI_local_bomber_production 
					# # has_completed_focus = CHI_sea_local_bomber_production 
				# # }
			# # } 
		# # }
	# }
# }

CHI_camco_organization_sea = {
	include = generic_light_aircraft_organization # generic_multi_role_aircraft_organization
	icon = GFX_idea_CHI_camco_sea 
	allowed = {
		is_literally_china = yes
		# has_dlc = "No Compromise, No Surrender" 
		has_dlc = "Arms Against Tyranny"
	}
	available = {
		# IF = {
			# limit = {
				# FROM = { NOT = { original_tag = CHI } }
			# }
			owner = { controls_state = 596 } # #596 Zhejiang
		# }
		# IF = {
			# limit = {
				# FROM = { original_tag = CHI }
			# }
			# OR = {
				# owner = { has_completed_focus = CHI_relocate_factories_from_the_coast }
				# owner = { controls_state = CHI.mio_locations^8 } # #596 Zhejiang
			# }
		# }
	}
}

CHI_sinaw_organization_sea = {
	include = generic_medium_aircraft_organization # generic_cas_aircraft_organization
	icon = GFX_idea_CHI_SINAW
	allowed = {
		is_literally_china = yes 
		# has_dlc = "No Compromise, No Surrender" 
		has_dlc = "Arms Against Tyranny"
	}
	available = {
		# IF = {
			# limit = {
				# FROM = { NOT = { original_tag = CHI } }
			# }
			owner = { controls_state = 600 } # #600 Jiangxi
		# }
		# IF = {
			# limit = {
				# FROM = { original_tag = CHI }
			# }
			# OR = {
				# owner = { has_completed_focus = CHI_relocate_factories_from_the_coast }
				# owner = { controls_state = CHI.mio_locations^9 } # #600 Jiangxi
			# }
		# }
	}
}

# CHI_soviet_aircraft_factory_in_xinjiang_organization = { # TODO
	# include = generic_light_aircraft_organization
	# icon = GFX_idea_generic_air_manufacturer_3
	# allowed = {
		# original_tag = CHI
		# has_dlc = "Arms Against Tyranny"
	# }
	# available = {
		# FROM = { has_completed_focus = CHI_soviet_aircraft_factories_in_xinjiang }
		# SIK = {
			# exists = yes
			# has_government = communism
			# NOT = { has_war_with = ROOT }
		# }
	# }
# }

# CHI_nw_camco_organization = {
	# include = generic_multi_role_aircraft_organization
	# icon = GFX_idea_CHI_camco
	# allowed = {
		# original_tag = CHI
		# has_dlc = "Arms Against Tyranny"
	# }
# }

# CHI_sinaw_organization = {
	# include = generic_cas_aircraft_organization
	# icon = GFX_idea_generic_air_manufacturer_2
	# allowed = {
		# original_tag = CHI
		# has_dlc = "Arms Against Tyranny"
	# }
# }

################################### 

#   #  ##  ### ### ###  ### ### #   
## ## #  #  #  #   #  #  #  #   #   
# # # ####  #  ##  ###   #  ##  #   
#   # #  #  #  #   #  #  #  #   #   
#   # #  #  #  ### #  # ### ### ### 


###################################

CHI_taiyuan_arsenal_organization = {
	include = generic_artillery_organization
	icon = GFX_idea_generic_artillery_manufacturer_1
	allowed = {	
		is_literally_china = yes
		# NOT = { has_dlc = "No Compromise, No Surrender" }
		has_dlc = "Arms Against Tyranny"
	}
	available = {
		owner = { controls_state = 615 } # #615 Shanxi
	}
}
CHI_liaoning_arsenal_organization = {
	include = generic_motorized_mechanized_organization
	icon = GFX_idea_CHI_liaoning
	allowed = {	
		is_literally_china = yes
		NOT = { has_dlc = "No Compromise, No Surrender" } 
		has_dlc = "Arms Against Tyranny"
	}
	available = {
		owner = { controls_state = 715 } # #715 Liaobei
	}
}
CHI_hanyan_arsenal_organization = {
	include = generic_infantry_equipment_organization
	icon = GFX_idea_CHI_hanyang
	allowed = {	
		is_literally_china = yes
		NOT = { has_dlc = "No Compromise, No Surrender" }
		has_dlc = "Arms Against Tyranny"
	}
	available = {
		owner = { controls_state = 620 } ##1036 Wuhan
	}
}

CHI_mukden_arsenal_organization = {
	include = generic_infantry_equipment_organization
	icon = GFX_idea_CHI_mukden
	allowed = {	
		OR = {
			is_literally_china = yes
			original_tag = MAN
		}
		has_dlc = "Arms Against Tyranny"
	}
	available = {
		# IF = {
			# limit = {
				# FROM = { 
					# OR = {
						# NOT = { original_tag = CHI }
						# AND = {
							# original_tag = CHI 
							# NOT = { has_dlc = "No Compromise, No Surrender" }
						# }
					# }
				# }
			# }
			owner = { controls_state = 716 } # #716 Liaoning
		# }
		# IF = {
			# limit = {
				# FROM = { original_tag = CHI }
				# hidden_trigger = { has_dlc = "No Compromise, No Surrender" }
			# }
			# OR = {
				# owner = { has_completed_focus = CHI_relocate_factories_from_the_coast }
				# owner = { controls_state = CHI.mio_locations^5 } # #716 Liaoning
			# }
		# }
	}
}

CHI_taiyuan_arsenal_organization_sea = { # TODO
	include = generic_artillery_organization
	icon = GFX_idea_generic_artillery_manufacturer_1
	allowed = {	
		always = no
		is_literally_china = yes
		NOT = { original_tag = PRC } # TODO разобраться почему
		has_dlc = "No Compromise, No Surrender"
		has_dlc = "Arms Against Tyranny"
	}
	available = {
		# IF = {
			# limit = {
				# FROM = { NOT = { original_tag = CHI } }
			# }
			owner = { controls_state = 615 } # #615 Shanxi
		# }
		# IF = {
			# limit = {
				# FROM = { original_tag = CHI }
			# }
			# OR = {
				# owner = { has_completed_focus = CHI_relocate_factories_from_the_coast }
				# owner = { controls_state = CHI.mio_locations^2 } # #615 Shanxi
			# }
		# }
	}

}
CHI_liaoning_arsenal_organization_sea = {
	include = generic_motorized_mechanized_organization
	icon = GFX_idea_CHI_liaoning
	allowed = {	
		is_literally_china = yes
		has_dlc = "No Compromise, No Surrender"
		has_dlc = "Arms Against Tyranny"
	}
	available = {
		# IF = {
			# limit = {
				# FROM = { NOT = { original_tag = CHI } }
			# }
			owner = { controls_state = 715 } # #715 Liaobei
		# }
		# IF = {
			# limit = {
				# FROM = { original_tag = CHI }
			# }
			# OR = {
				# owner = { has_completed_focus = CHI_relocate_factories_from_the_coast } # TODO а тогда вообще нужна ли эта впошка?
				# owner = { controls_state = CHI.mio_locations^3 } # #715 Liaobei
			# }
		# }
	}
	override_trait = {
		token = generic_mio_trait_all_wheel_drive
		position = { x=0 y=2 }
		mutually_exclusive = { generic_mio_trait_long_range_priority }
	}

	add_trait = {
		token = generic_mio_trait_long_range_priority
		name = generic_mio_trait_long_range_priority
		icon = GFX_generic_mio_trait_icon_breakthrough
		special_trait_background = yes
		
		position = { x=2 y=2 }
		relative_position_id = generic_mio_trait_composite_cargo_bed
		mutually_exclusive = { generic_mio_trait_all_wheel_drive }
		any_parent = { generic_mio_trait_composite_cargo_bed generic_mio_trait_steel_cargo_bed }
		all_parents = { generic_mio_trait_medium_machinegun_mounts }

		limit_to_equipment_type = { motorized_equipment motorized_rocket_equipment }
		
		equipment_bonus = {
			fuel_consumption = -0.03
		}
	}

	override_trait = {
		token = generic_mio_trait_attached_wood_gas_generator
		position = { x=0 y=2 }
		any_parent = { generic_mio_trait_all_wheel_drive generic_mio_trait_long_range_priority }
	}

	trait = {
		token = generic_mio_trait_high_powered_engine
		any_parent = { generic_mio_trait_all_wheel_drive generic_mio_trait_long_range_priority }
	}

	add_trait = {
		token = generic_mio_trait_sufficient_armor
		name = generic_mio_trait_sufficient_armor
		icon = GFX_generic_mio_trait_icon_breakthrough
		special_trait_background = yes
		
		position = { x=0 y=2 }
		relative_position_id = generic_mio_trait_open_chassi
		mutually_exclusive = { generic_mio_trait_bulletproof_panels }
		any_parent = { generic_mio_trait_open_chassi generic_mio_trait_closed_chassi }
		all_parents = { generic_mio_trait_medium_machinegun_mounts }
		
		limit_to_equipment_type = { mechanized_equipment}
		
		equipment_bonus = {
			armor_value = -0.03
			build_cost_ic = -0.05
		}
	}

	override_trait = {
		token = generic_mio_trait_bulletproof_panels
		position = { x=0 y=2 }
		mutually_exclusive = { generic_mio_trait_sufficient_armor }
	}

	override_trait = {
		token = generic_mio_trait_mounted_light_anti_tank_gun #elephant gun
		any_parent = { generic_mio_trait_bulletproof_panels generic_mio_trait_sufficient_armor }
	}

	override_trait = {
		token = generic_mio_trait_light_flame_projectors
		position = { x=-1 y=2 }
		any_parent = { generic_mio_trait_bulletproof_panels generic_mio_trait_sufficient_armor }
	}

	override_trait = {
		token = generic_mio_trait_land_mine_racks
		any_parent = { generic_mio_trait_bulletproof_panels generic_mio_trait_sufficient_armor }
	}
}
CHI_hanyan_arsenal_organization_sea = {
	include = generic_infantry_equipment_organization
	icon = GFX_idea_CHI_hanyang
	allowed = {	
		is_literally_china = yes
		NOT = { original_tag = PRC }
		has_dlc = "No Compromise, No Surrender"
		has_dlc = "Arms Against Tyranny"
	}
	available = {
		# IF = {
			# limit = {
				# FROM = { NOT = { original_tag = CHI } }
			# }
			owner = { controls_state = 620 } ##1036 Wuhan
		# }
		# IF = {
			# limit = {
				# FROM = { original_tag = CHI }
			# }
			# OR = {
				# owner = { has_completed_focus = CHI_relocate_factories_from_the_coast }
				# owner = { controls_state = CHI.mio_locations^4 } ##1036 Wuhan
			# }
		# }
	}
	

	add_trait = {
		token = generic_mio_trait_locally_sourced_alloys
		name = generic_mio_trait_locally_sourced_alloys
		icon = GFX_generic_mio_trait_icon_resources
		position = { x=1 y=2 }
		relative_position_id = generic_mio_trait_drum_pattern_sights
		all_parents = { generic_mio_trait_drum_pattern_sights }
		special_trait_background = yes
		production_bonus = {
			production_resource_need_factor = -0.1
		}
	}

	override_trait = {
		token = generic_mio_trait_quality_materials
		position = { x=-1 y=2 }
	}

	override_trait = {
		token = generic_mio_trait_improved_small_arms_bullet_design
		position = { x=0 y=2 }
		any_parent = { generic_mio_trait_quality_materials generic_mio_trait_locally_sourced_alloys}
	}

	override_trait = {
		token = generic_mio_trait_armor_piercing_rounds
		position = { x=2 y=2 }
		any_parent = { generic_mio_trait_quality_materials generic_mio_trait_locally_sourced_alloys}
	}

	add_trait = {
		token = generic_mio_trait_fully_auto_pistol
		name = generic_mio_trait_fully_auto_pistol
		icon = GFX_generic_mio_trait_icon_breakthrough

		position = { x=0 y=2 }
		relative_position_id = generic_mio_trait_bolt_action

		any_parent = { generic_mio_trait_semi_auto generic_mio_trait_bolt_action }
		special_trait_background = yes

		mutually_exclusive = { generic_mio_trait_medium_machineguns }
		
		equipment_bonus = {
			breakthrough = 0.01
			build_cost_ic = -0.05
		}
	}

	override_trait = {
		token = generic_mio_trait_medium_machineguns
		position = { x=2 y=2 }
		mutually_exclusive = { generic_mio_trait_fully_auto_pistol }
	}

}

CHI_china_automobile_corporation_organization = {
	include = generic_motorized_mechanized_organization
	icon = GFX_idea_CHI_cac
	allowed = {	
		is_literally_china = yes
		NOT = { original_tag = PRC }
		has_dlc = "No Compromise, No Surrender"
		has_dlc = "Arms Against Tyranny"
	}
	available = {
		# IF = {
			# limit = {
				# FROM = { NOT = { original_tag = CHI } }
			# }
			owner = { controls_state = 613 } # 613 Shanghai
		# }
		# IF = {
			# limit = {
				# FROM = { original_tag = CHI }
			# }
			# OR = {
				# owner = { has_completed_focus = CHI_relocate_factories_from_the_coast }
				# owner = { controls_state = CHI.mio_locations^6 } # 613 Shanghai
			# }
		# }
	}
	override_trait = {
		token = generic_mio_trait_all_wheel_drive
		position = { x=0 y=2 }
		mutually_exclusive = { generic_mio_trait_long_range_priority }
	}

	add_trait = {
		token = generic_mio_trait_long_range_priority
		name = generic_mio_trait_long_range_priority
		icon = GFX_generic_mio_trait_icon_breakthrough
		special_trait_background = yes
		
		position = { x=2 y=2 }
		relative_position_id = generic_mio_trait_composite_cargo_bed
		mutually_exclusive = { generic_mio_trait_all_wheel_drive }
		any_parent = { generic_mio_trait_composite_cargo_bed generic_mio_trait_steel_cargo_bed }
		all_parents = { generic_mio_trait_medium_machinegun_mounts }

		limit_to_equipment_type = { motorized_equipment motorized_rocket_equipment }
		
		equipment_bonus = {
			fuel_consumption = -0.03
		}
	}

	override_trait = {
		token = generic_mio_trait_attached_wood_gas_generator
		position = { x=0 y=2 }
		any_parent = { generic_mio_trait_all_wheel_drive generic_mio_trait_long_range_priority }
	}

	trait = {
		token = generic_mio_trait_high_powered_engine
		any_parent = { generic_mio_trait_all_wheel_drive generic_mio_trait_long_range_priority }
	}

	add_trait = {
		token = generic_mio_trait_sufficient_armor
		name = generic_mio_trait_sufficient_armor
		icon = GFX_generic_mio_trait_icon_breakthrough
		special_trait_background = yes
		
		position = { x=0 y=2 }
		relative_position_id = generic_mio_trait_open_chassi
		mutually_exclusive = { generic_mio_trait_bulletproof_panels }
		any_parent = { generic_mio_trait_open_chassi generic_mio_trait_closed_chassi }
		all_parents = { generic_mio_trait_medium_machinegun_mounts }
		
		limit_to_equipment_type = { mechanized_equipment}
		
		equipment_bonus = {
			armor_value = -0.03
			build_cost_ic = -0.05
		}
	}

	override_trait = {
		token = generic_mio_trait_bulletproof_panels
		position = { x=0 y=2 }
		mutually_exclusive = { generic_mio_trait_sufficient_armor }
	}

	override_trait = {
		token = generic_mio_trait_mounted_light_anti_tank_gun #elephant gun
		any_parent = { generic_mio_trait_bulletproof_panels generic_mio_trait_sufficient_armor }
	}

	override_trait = {
		token = generic_mio_trait_light_flame_projectors
		position = { x=-1 y=2 }
		any_parent = { generic_mio_trait_bulletproof_panels generic_mio_trait_sufficient_armor }
	}

	override_trait = {
		token = generic_mio_trait_land_mine_racks
		any_parent = { generic_mio_trait_bulletproof_panels generic_mio_trait_sufficient_armor }
	}
}

CHI_jinling_arsenal_organization = {
	include = generic_support_equipment_organization
	icon = GFX_idea_CHI_jinling
	allowed = {	
		is_literally_china = yes
		NOT = { original_tag = PRC }
		has_dlc = "No Compromise, No Surrender"
		has_dlc = "Arms Against Tyranny"
	}
	available = {
		# IF = {
			# limit = {
				# FROM = { NOT = { original_tag = CHI } }
			# }
			owner = { controls_state = 613 } # 1035 Nanjing
		# }
		# IF = {
			# limit = {
				# FROM = { original_tag = CHI }
			# }
			# OR = {
				# owner = { has_completed_focus = CHI_relocate_factories_from_the_coast }
				# owner = { controls_state = CHI.mio_locations^6 } # 1035 Nanjing
			# }
		# }
	}

}

# CHI_taiyuan_arsenal_organization = {
	# name = "«Shanxi Machinery Bureau»"
	# include = generic_artillery_organization
	# icon = GFX_idea_generic_artillery_manufacturer_1
	# allowed = {
		# OR = {
			# is_literally_china = yes
			# original_tag = MAN
			# original_tag = MEN
		# } 
		# has_dlc = "Arms Against Tyranny"
	# }
	# available = {
		# FROM = { controls_state = 615 }
	# }
# }

# CHI_central_machine_manufacturing_plant_organization = { # TODO !!
	# include = generic_motorized_mechanized_organization
	# icon = GFX_idea_generic_motorized_equipment_manufacturer_2
	# allowed = {
		# original_tag = CHI
		# has_dlc = "Arms Against Tyranny"
	# }
	# available = { FROM = { has_completed_focus = CHI_central_machine_manufacturing_plant } }
# }

# CHI_hanyan_arsenal_organization = {
	# name = "«Hangyang Arsenal»"
	# include = generic_infantry_equipment_organization
	# icon = GFX_idea_generic_infantry_equipment_manufacturer_3
	# allowed = {
		# OR = {
			# is_literally_china = yes
			# original_tag = MAN
			# original_tag = MEN
		# } 
		# has_dlc = "Arms Against Tyranny"
	# }
	# available = {
		# FROM = { controls_state = 620 }
	# }
# }

# CHI_kunxiang_arsenal_organization = {	TODO
	# name = "«Kunxiang Arsenal»"
	# include = generic_support_equipment_organization
	# icon = GFX_idea_generic_infantry_equipment_manufacturer_1
	# allowed = {
		# is_literally_china = yes
		# has_dlc = "Arms Against Tyranny"
	# }
	# available = {
		# FROM = { controls_state = 748 }
	# }
	# initial_trait = {
		# name = helmet_manufacturer
		# limit_to_equipment_type = {
			# support_equipment
		# }
		# organization_modifier = {
			# military_industrial_organization_research_bonus = 0.075
		# }
		# equipment_bonus = {
			# defense = 0.05
		# }
	# }
# }

CHI_china_development_financial_corporation_organization = {
	name = "«China Development Financial Corporation»"
	include = generic_building_organization
	icon = GFX_idea_generic_improved_repair
	allowed = {
		original_tag = CHI
		has_dlc = "Arms Against Tyranny"
	}
}