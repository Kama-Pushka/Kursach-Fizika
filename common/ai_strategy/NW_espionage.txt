build_intelligence_agency_major = {
	allowed = {
		has_dlc_lar = yes
	}
	enable = {
		is_major = yes
		date > 1937.1.1
		num_of_civilian_factories_available_for_projects > 25
	}
	abort = {
		OR = {
			is_major = no
			num_of_civilian_factories_available_for_projects < 15
		}
	}

	ai_strategy = {
		type = intelligence_agency_usable_factories
		value = 5
	}
}

build_intelligence_agency = {
	allowed = {
		has_dlc = "La Resistance"
		NOT = {
			tag = SAI
			tag = BUL
		}
	}
	enable = {
		is_major = no
		date > 1939.1.1
		num_of_civilian_factories_available_for_projects > 25
	}
	abort = {
		OR = {
			is_major = yes
			num_of_civilian_factories_available_for_projects < 15
		}
	}

	ai_strategy = {
		type = intelligence_agency_usable_factories
		value = 5
	}
}


upgrade_intelligence_agency = {
	allowed = {
		has_dlc = "La Resistance"
		NOT = { tag = SAI }
	}
	enable = {
		has_intelligence_agency = yes
		date > 1940.1.1
		num_of_civilian_factories_available_for_projects > 50
	}
	abort = {
		num_of_civilian_factories_available_for_projects < 40
	}

	ai_strategy = {
		type = intelligence_agency_usable_factories
		value = 5
	}
}

upgrade_intelligence_agency_as_spy_master = {
	allowed = {
		has_dlc = "La Resistance"
		NOT = { tag = SAI }
	}
	enable = {
		is_spymaster = yes
		num_of_civilian_factories_available_for_projects > 50
	}
	abort = {
		OR = {
			is_spymaster = no
			num_of_civilian_factories_available_for_projects < 40
		}
	}

	ai_strategy = {
		type = intelligence_agency_usable_factories
		value = 10
	}
}

more_upgrades_as_spymaster = {
	allowed = {
		has_dlc = "La Resistance"
		NOT = { tag = SAI }
	}
	enable = {
		is_spymaster = yes
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = agency_ai_base_num_factories_factor
		value = -50    # -50% on the define
	}

	ai_strategy = {
		type = agency_ai_per_upgrade_factories_factor
		value = -25    # -25% on the define
	}
}

addintelligence_agency_normal_upgrade_prio = {
	allowed = {
		has_dlc = "La Resistance"
		NOT = { tag = SAI }
	}
	enable = { always = yes }
	abort_when_not_enabled = yes

	ai_strategy = {
		type = intelligence_agency_branch_desire_factor
		id = branch_intelligence
		value = 1000
	}
	ai_strategy = {
		type = intelligence_agency_branch_desire_factor
		id = branch_defense
		value = 1000
	}
	ai_strategy = {
		type = intelligence_agency_branch_desire_factor
		id = branch_operation
		value = 500
	}
	ai_strategy = {
		type = intelligence_agency_branch_desire_factor
		id = branch_operative
		value = 100
	}
	ai_strategy = {
		type = intelligence_agency_branch_desire_factor
		id = branch_crypto
		value = 2000
	}
}

put_garrisons_on_high_prio = {
	allowed = {
		NOT = { tag = SAI }
	}
	enable = {
		always = yes
	}
	abort = {
		always = no
	}

	ai_strategy = {
		type = garrison_reinforcement_priority
		value = 100 # positive is high prio, negative is low prio
	}
}


#generic_operation_fake_intel = {
#	allowed = {
#		has_dlc = "La Resistance"
#	}
#	
#	enable = {
#		has_intelligence_agency = yes
#		check_variable = { num_fake_intel_divisions < 50 }
#	}
#	abort_when_not_enabled = yes
#	
#	ai_strategy = {
#		type = operative_operation
#		operation = operation_fake_intel
#		value = 75
#		operation_target = FIT
#	}
#	
#	ai_strategy = {
#		type = operative_mission
#		mission = build_intel_network
#		value = 3000
#		mission_target = FIT
#	}
#}