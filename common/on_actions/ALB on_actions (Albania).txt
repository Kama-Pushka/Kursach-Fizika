on_actions = {

	on_startup = {
		effect = {
			if = {
				limit = { has_start_date < 1936.01.02 }
				### Албания стартпак
				ALB = {
					country_event = { days = 31 id = NWalbania.2 }
					country_event = { days = 186 id = NWalbania.6 }
					country_event = { days = 277 id = NWalbania.9 }
					country_event = { days = 310 id = NWalbania.16 } # 7 ноября
					country_event = { days = 147 id = NWalbania.70 } # 28 мая 1936 
					country_event = { days = 847 id = NWalbania.1400 }
					country_event = { days = 1190 id = NWalbania.20000 } 
				
					give_resource_rights = { receiver = ITA state = 44 }
				}
			}
		}
	}
	
	on_government_change = {
		### ALBANIA
		effect = {
			if = {
				limit = {
					has_government = communism
					NOT = { has_opinion_modifier = red_bishop }
					any_country_with_original_tag = {
						original_tag_to_check = ALB
						has_country_leader_with_trait = red_bishop
					}
				}
				random_country_with_original_tag = {
					original_tag_to_check = ALB
					limit = { has_country_leader_with_trait = red_bishop }
					add_opinion_modifier = { target = ROOT modifier = red_bishop }
					ROOT = { add_opinion_modifier = { target = PREV modifier = red_bishop } }
				}
			}
			if = {
				limit = {
					NOT = { has_government = communism }
					has_opinion_modifier = red_bishop
				}
				every_country_with_original_tag = {
					original_tag_to_check = ALB
					remove_opinion_modifier = { target = ROOT modifier = red_bishop }
					ROOT = { remove_opinion_modifier = { target = PREV modifier = red_bishop } }
				}
			}
		}
		effect = {
			if = {
				limit = {
					original_tag = ALB
				}
				if = {
					limit = { has_country_leader_with_trait = red_bishop }
					every_country = {
						limit = { has_government = communism }
						add_opinion_modifier = { target = ROOT modifier = red_bishop }
						ROOT = { add_opinion_modifier = { target = PREV modifier = red_bishop } }
					}
					else = {
						every_country = {
							limit = { has_government = communism }
							remove_opinion_modifier = { target = ROOT modifier = red_bishop }
							ROOT = { remove_opinion_modifier = { target = PREV modifier = red_bishop } }
						}
					}
				}
				
				if = {
					limit = {
						OR = {
							has_government = monarchy
							has_completed_focus = ALB_invite_fan_noli
						}
						NOT = {
							OR = {
							    has_character = ALB_prenk_pervizi
							    has_character = ALB_xhemal_aranitasi
							    has_character = ALB_king_zog
							}	
						}
					}
					random_other_country = {
						limit = {
							has_character = ALB_prenk_pervizi
						}
						ALB_prenk_pervizi = {
							set_nationality = ROOT
						}
					}
					random_other_country = {
						limit = {
							has_character = ALB_xhemal_aranitasi
						}
						ALB_xhemal_aranitasi = {
							set_nationality = ROOT
						}
					}
					random_other_country = {
						limit = {
							has_character = ALB_king_zog
						}
						ALB_king_zog = {
							set_nationality = ROOT
						}
					}
					ALB_king_zog = {
						promote_leader = yes
					}
				}	
				
				if = {
					limit = {
						NOT = {
							OR = {
								has_government = monarchy
								has_completed_focus = ALB_invite_fan_noli
							}
						}
						OR = {
							has_character = ALB_prenk_pervizi
							has_character = ALB_xhemal_aranitasi
							has_character = ALB_king_zog
						}
					}
					ALB_prenk_pervizi = {
						set_nationality = SAI
					}
					ALB_xhemal_aranitasi = {
						set_nationality = SAI
					}
					ALB_king_zog = {
						set_nationality = SAI
					}
				}
				
				if = {
					limit = {
						NOT = {
							OR = {
								has_government = neutrality
								has_government = communism
								has_government = trozkism
							}
							NOT = {
								has_character = ALB_gustav_von_myrdacz
							}
						}	
					}
					random_other_country = {
						limit = {
							has_character = ALB_gustav_von_myrdacz
						}
						ALB_gustav_von_myrdacz = {
							set_nationality = ROOT
						}
					}
				}	
				
				if = {
					limit = {
						NOT = {
							OR = {
								has_government = neutrality
								has_government = communism
								has_government = trozkism
							}
							has_character = ALB_gustav_von_myrdacz
						}
					}
					ALB_gustav_von_myrdacz = {
						set_nationality = SAI
					}
				}
				
				if = {
					limit = {
						OR = {
							has_government = democratic
							has_government = monarchy
						}
						NOT = {
							has_character = ALB_fiqri_dine
						}
					}
					random_other_country = {
						limit = {
							has_character = ALB_fiqri_dine
						}
						ALB_fiqri_dine = {
							set_nationality = ROOT
						}
					}
					else_if = {
						limit = {
							NOT = {
								OR = {
									has_government = democratic
									has_government = monarchy
								}
							}
							has_character = ALB_fiqri_dine
						}
						ALB_fiqri_dine = {
							set_nationality = SAI
						}
					}
				}
				
				#КОМ ГЕНЕРАЛЫ
				if = {
					limit = {
						has_government = communism
						NOT = {
							OR = {
							    has_character = ALB_spiro_moisiu
							    has_character = ALB_enver_hoxha
							    has_character = ALB_koci_xoxe
							    has_character = ALB_mehmet_shehu
							    has_character = ALB_beqir_balluku
					        } 						
						}
					}
					random_other_country = {
						limit = {
							has_character = ALB_spiro_moisiu
						}
						ALB_spiro_moisiu = {
							set_nationality = ROOT
						}
					}
					random_other_country = {
						limit = {
							has_character = ALB_enver_hoxha
						}
						ALB_enver_hoxha = {
							set_nationality = ROOT
						}
					}
					random_other_country = {
						limit = {
							has_character = ALB_koci_xoxe
						}
						ALB_koci_xoxe = {
							set_nationality = ROOT
						}
					}
					random_other_country = {
						limit = {
							has_character = ALB_mehmet_shehu
						}
						ALB_mehmet_shehu = {
							set_nationality = ROOT
						}
					}
					random_other_country = {
						limit = {
							has_character = ALB_beqir_balluku
						}
						ALB_beqir_balluku = {
							set_nationality = ROOT
						}
					}
				}
					
				if = {
					limit = {
						NOT = {
							has_government = communism
						}
						OR = {
						    has_character = ALB_spiro_moisiu
						    has_character = ALB_enver_hoxha
							has_character = ALB_koci_xoxe
							has_character = ALB_mehmet_shehu
							has_character = ALB_beqir_balluku
						}
					}
					ALB_spiro_moisiu = {
						set_nationality = SAI
					}
					ALB_enver_hoxha = {
						set_nationality = SAI
					}
					ALB_koci_xoxe = {
						set_nationality = SAI
					}
					ALB_mehmet_shehu = {
						set_nationality = SAI
					}
					ALB_beqir_balluku = {
						set_nationality = SAI
					}
				}
				
				#ТРО ГЕНЕРАЛЫ
				if = {
					limit = {
						has_government = trozkism
						NOT = {
							OR = {
							    has_character = ALB_spiro_moisiu
							    has_character = ALB_mehmet_shehu
							    has_character = ALB_beqir_balluku
					        } 						
						}
					}
					random_other_country = {
						limit = {
							has_character = ALB_spiro_moisiu
						}
						ALB_spiro_moisiu = {
							set_nationality = ROOT
						}
					}
					random_other_country = {
						limit = {
							has_character = ALB_mehmet_shehu
						}
						ALB_mehmet_shehu = {
							set_nationality = ROOT
						}
					}
					random_other_country = {
						limit = {
							has_character = ALB_beqir_balluku
						}
						ALB_beqir_balluku = {
							set_nationality = ROOT
						}
					}
				}	
				if = {
					limit = {
						NOT = {
							has_government = trozkism
						}
						OR = {
							has_character = ALB_spiro_moisiu
							has_character = ALB_mehmet_shehu
						    has_character = ALB_beqir_balluku
						}
					}
					ALB_spiro_moisiu = {
						set_nationality = SAI
					}
					ALB_mehmet_shehu = {
						set_nationality = SAI
					}
					ALB_beqir_balluku = {
						set_nationality = SAI
					}
				}
				
				#ФАШ ГЕНЕРАЛЫ
				if = {
					limit = {
						has_government = fascism
						NOT = {
							has_character = ALB_ndok_gjeloshi
						}
					}
					random_other_country = {
						limit = {
							has_character = ALB_ndok_gjeloshi
						}
						ALB_ndok_gjeloshi = {
							set_nationality = ROOT
						}
					}
				}
				
				if = {
					limit = {
						NOT = {
							has_government = fascism
						}
						has_character = ALB_ndok_gjeloshi
					}
					ALB_ndok_gjeloshi = {
						set_nationality = SAI
						
					}
				}
				
				#АВТОРИТАРИТАРНЫЕ ГЕНЕРАЛЫ
				if = {
					limit = {
						has_government = neutrality
						NOT = {
							OR = {
							    has_character = ALB_prek_cali
							    has_character = ALB_gjon_markagjoni
							}	
						}
					}
					random_other_country = {
						limit = {
							has_character = ALB_prek_cali
						}
						ALB_prek_cali = {
							set_nationality = ROOT
						}
					}
					random_other_country = {
						limit = {
							has_character = ALB_gjon_markagjoni
						}
						ALB_gjon_markagjoni = {
							set_nationality = ROOT
						}
					}
				}	
				if = {
					limit = {
						NOT = {
							has_government = neutrality
						}
						OR = {
						    has_character = ALB_prek_cali
						    has_character = ALB_gjon_markagjoni
						}
					}
					ALB_prek_cali = {
						set_nationality = SAI
					}
					ALB_gjon_markagjoni = {
						set_nationality = SAI
					}
				}
				
				#КАМБЕТАР
				if = {
					limit = {
						has_country_leader_with_trait =	father_of_albanian_nationalism
						NOT = {
							OR = {
							    has_character = ALB_muharrem_bajraktari
							    has_character = ALB_aziz_cami
							}	
						}
					}
					random_other_country = {
						limit = {
							has_character = ALB_muharrem_bajraktari
						}
						ALB_muharrem_bajraktari = {
							set_nationality = ROOT
						}
					}
					random_other_country = {
						limit = {
							has_character = ALB_aziz_cami
						}
						ALB_aziz_cami = {
							set_nationality = ROOT
						}
					}
				}	
				if = {
					limit = {
						NOT = {
							has_country_leader_with_trait =	father_of_albanian_nationalism
						}
						OR = {
						    has_character = ALB_muharrem_bajraktari
						    has_character = ALB_aziz_cami
						}
					}
					ALB_muharrem_bajraktari = {
						set_nationality = SAI
					}
					ALB_aziz_cami = {
						set_nationality = SAI
					}
				}
			}
		}
	}
	
	#FROM is war target
	on_declare_war = {
		#Таймер перемирия | АЛБАНИЯ
		effect = {
			if = {
				limit = {
					FROM = { original_tag = ALB }
					tag = ITA
				}
				ALB = { set_country_flag = { flag = ALB_timer_whitepeace_year	days = 365	value = 1 } }
			}
		}
	}
	
	#ROOT is winner #FROM gets annexed - This will also fire on_annex
	on_civil_war_end = {
		### ALB
		effect = {
			#Камбетар победил, ивент
			if = {
				limit = {
					original_tag = ALB
					has_government = democratic
				}
				ALB = { country_event = { id = NWalbania.51 hours = 3 } }
				news_event = NWalbania.68
				delete_unit_template_and_units = {
					division_template = "Militia of Great Albania"
					disband = yes
				}
			}
			#Ходжа победил
			if = {
				limit = {
					original_tag = ALB
					has_government = communism
					has_country_leader_with_trait = paranoid
				}
				news_event = NWalbania.65
				delete_unit_template_and_units = {
					division_template = "Revolutionary militia of Albania"
					disband = yes
				}
			}
			#Дзодзе
			if = {
				limit = {
					original_tag = ALB
					has_government = communism
					has_country_leader_with_trait = head_of_the_punitive_apparatus
				}
				news_event = NWalbania.66
				delete_unit_template_and_units = {
					division_template = "Revolutionary militia of Albania"
					disband = yes
				}
			}
			if = {
				limit = {
					original_tag = ALB
					has_government = trozkism
				}
				news_event = NWalbania.67
				delete_unit_template_and_units = {
					division_template = "Revolutionary militia of Albania"
					disband = yes
				}
			}
			if = {
				limit = {
					original_tag = ALB
					has_government = neutrality
				}
				if = {
					limit = { country_exists = GRE }
					GRE = {
						every_controlled_state = {
							limit = {
								any_neighbor_state = {
									is_controlled_by = ROOT
								}
							}
							set_demilitarized_zone = no
						}
					}
				}
				if = {
					limit = { country_exists = CRE }
					CRE = {
						every_controlled_state = {
							limit = {
								any_neighbor_state = {
									is_controlled_by = ROOT
								}
							}
							set_demilitarized_zone = no
						}
					}
				}
				if = {
					limit = { country_exists = HEL }
					HEL = {
						every_controlled_state = {
							limit = {
								any_neighbor_state = {
									is_controlled_by = ROOT
								}
							}
							set_demilitarized_zone = no
						}
					}
				}
			}
		}
	}
	
	on_weekly_ALB = {
		effect = {
			## паранойя
			if = {
				limit = {
					OR = {
						has_idea = ALB_paranoia_of_secretary
						has_idea = ALB_paranoia_of_secretary_2
					}
				}
				add_to_variable = { 
					var = alb_paranoia_var
					value = 1
				}
			}
			if = {
				limit = {
					OR = {
						has_idea = ALB_paranoia_of_secretary_3
						has_idea = ALB_paranoia_of_secretary_4
					}
				}
				add_to_variable = { 
					var = alb_paranoia_var
					value = 2
				}
			}
		}
	}
}